"use strict";(self["webpackChunkthreat_dragon"]=self["webpackChunkthreat_dragon"]||[]).push([[590],{2082:function(e,t,r){r.d(t,{A:function(){return l}});var a=function(){var e=this,t=e._self._c;return t("b-container",{attrs:{fluid:""}},[t("b-row",[t("b-col",[t("b-jumbotron",{staticClass:"text-center"},[t("h4",[e._t("default")],2)])],1)],1),t("b-row",[t("b-col",{attrs:{md:"6",offset:"3"}},[t("b-form",[t("b-form-row",[t("b-col",[t("b-form-group",{attrs:{id:"filter-group"}},[t("b-form-input",{attrs:{id:"filter",placeholder:e.$t("forms.search")},model:{value:e.localFilter,callback:function(t){e.localFilter=t},expression:"localFilter"}})],1)],1)],1)],1)],1)],1),t("b-row",[t("b-col",{attrs:{md:"6",offset:"3"}},[t("b-list-group",[e.showBackItem?t("b-list-group-item",{attrs:{href:"javascript:void(0)"},on:{click:e.onBackClick}},[e._v(" ... ")]):e._e(),0===e.items.length&&e.emptyStateText?t("b-list-group-item",{attrs:{href:"javascript:void(0)"},on:{click:e.onEmptyStateClick}},[e._v(" "+e._s(e.emptyStateText)+" ")]):e._e(),e._l(e.displayedItems,(function(r,a){return t("b-list-group-item",{key:a,attrs:{href:"javascript:void(0)"},on:{click:function(t){return e.onItemClick(r)}}},["string"===typeof r?t("span",[e._v(e._s(r))]):t("span",{staticClass:"d-flex justify-content-between align-items-center"},[e._v(" "+e._s(r.value)+" "),r.icon?t("font-awesome-icon",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{icon:r.icon,title:e.$t(r.iconTooltip)||""}}):e._e()],1)])}))],2)],1)],1),t("b-row",[t("b-col",{attrs:{md:"6",offset:"3"}},[t("div",{staticClass:"pagination"},[t("button",{attrs:{disabled:!e.pagePrev},on:{click:function(t){return e.paginate(--e.pageRef)}}},[e._v("Previous")]),t("button",{staticClass:"btn",attrs:{"data-toggle":"buttons",disabled:!0}},[e._v(e._s(e.pageRef))]),t("button",{attrs:{disabled:!e.pageNext},on:{click:function(t){return e.paginate(++e.pageRef)}}},[e._v("Next")])])])],1)],1)},i=[],o={name:"TdSelectionPage",data(){return{pageRef:this.page,localFilter:this.filter}},watch:{filter(e){this.localFilter=e},localFilter(e){this.$emit("update:filter",e)}},props:{filter:{required:!1,type:String,default:""},items:{required:!0,type:Array,validator:e=>e.every((e=>"string"===typeof e||e.value&&"string"===typeof e.value&&(!e.icon||"string"===typeof e.icon)&&(!e.iconTooltip||"string"===typeof e.iconTooltip&&e.icon)))},page:{required:!1,type:Number,default:1},pageNext:{required:!1,type:Boolean,default:!1},pagePrev:{required:!1,type:Boolean,default:!1},paginate:{required:!1,type:Function},onItemClick:{required:!0,type:Function},emptyStateText:{required:!1,type:String},onEmptyStateClick:{required:!1,type:Function,default:()=>{}},showBackItem:{required:!1,type:Boolean,default:!1},onBackClick:{required:!1,type:Function,default:()=>{}},isGoogleProvider:{required:!1,type:Boolean,default:!1}},computed:{displayedItems:function(){return this.filter?this.$props.isGoogleProvider?this.items.filter((e=>e.name.toLowerCase().includes(this.filter.toLowerCase()))):(console.log(this.items),this.items.filter((e=>(e.value||e).toLowerCase().includes(this.filter.toLowerCase())))):this.items}}},s=o,n=r(1656),c=(0,n.A)(s,a,i,!1,null,null,null),l=c.exports},3343:function(e,t,r){r.r(t),r.d(t,{default:function(){return N}});var a=function(){var e=this,t=e._self._c;return t("td-selection-page",{attrs:{items:e.branches,page:e.page,pageNext:e.pageNext,pagePrev:e.pagePrev,onItemClick:e.onBranchClick,paginate:e.paginate}},[e._v(" "+e._s(e.$t("branch.select"))+" "),t("a",{attrs:{id:"repo_link",href:`${e.providerUri}/${e.repoName}`,target:"_blank",rel:"noopener noreferrer"}},[e._v(e._s(e.repoName))]),e._v(" "+e._s(e.$t("branch.from"))+" "),t("a",{attrs:{href:"javascript:void(0)",id:"return-to-repo"},on:{click:e.selectRepoClick}},[e._v(" "+e._s(e.$t("branch.chooseRepo"))+" ")]),e._v(" "+e._s(e.$t("branch.or"))+" "),t("a",{attrs:{href:"javascript:void(0)",id:"new-branch"},on:{click:function(t){return e.toggleNewBranchDialog()}}},[e._v(e._s(e.$t("branch.addNew")))]),e.showNewBranchDialog?t("add-branch-modal",{attrs:{branches:e.branches},on:{"close-dialog":function(t){return e.toggleNewBranchDialog()}}}):e._e()],1)},i=[],o=r(5353),s=r(6749),n=r(4023),c=r(5332),l=r(2317),h=r(2082),p=function(){var e=this,t=e._self._c;return t("b-modal",{attrs:{id:"add-new-branch",size:"md","ok-variant":"primary","header-bg-variant":"primary","header-text-variant":"light",title:e.modalTitle,visible:"",centered:"","hide-footer":""},on:{hide:e.closeDialog}},[t("form",{on:{submit:function(t){return t.preventDefault(),e.addBranch.apply(null,arguments)}}},[t("b-row",[t("b-col",{staticClass:"pb-2",attrs:{lg:"12"}},[t("b-form-group",{attrs:{id:"input-group-1",label:e.$t("branch.name"),"label-for":"branchName"}},[t("b-form-input",{attrs:{type:"text",id:"branchName",state:e.isError,"lazy-formatter":"",trim:"",required:""},on:{input:e.validate},model:{value:e.newBranchName,callback:function(t){e.newBranchName=t},expression:"newBranchName"}}),t("b-form-invalid-feedback",{attrs:{state:e.isError}},[e._v(" "+e._s(e.branchNameError)+" ")])],1)],1)],1),t("b-row",[t("b-col",{staticClass:"pb-2",attrs:{lg:"12"}},[t("b-form-group",{attrs:{id:"input-group-2",label:e.$t("branch.refBranch"),"label-for":"refBranch"}},[t("b-form-select",{attrs:{id:"refBranch",options:e.branchNames,size:"md",required:""},model:{value:e.refBranch,callback:function(t){e.refBranch=t},expression:"refBranch"}})],1)],1)],1)],1),t("hr"),t("div",{staticClass:"d-flex justify-content-end"},[t("b-overlay",{attrs:{show:e.wait,variant:"light",blur:"true",opacity:"0.8","spinner-small":""}},[t("b-button",{staticClass:"m-1",attrs:{variant:"primary",type:"submit"},on:{click:e.addBranch}},[e._v(e._s(e.$t("branch.add")))])],1),t("b-button",{staticClass:"m-1",attrs:{variant:"secondary"},on:{click:e.closeDialog}},[e._v(e._s(e.$t("branch.cancel")))])],1)])},d=[],u={name:"AddBranchModal",props:{branches:{type:Array,validator:e=>e.every((e=>"string"===typeof e||e.value&&"string"===typeof e.value)),required:!0}},data(){return{newBranchName:"",refBranch:"",modalTitle:this.$t("branch.addNew"),branchNameError:"",isError:null,wait:!1}},computed:{branchNames(){return this.branches.map((e=>e.value||e))}},mounted(){this.refBranch=this.branchNames.slice(-1)[0]},watch:{branches:function(e){e.length>0&&(this.refBranch=this.branchNames.slice(-1)[0])}},methods:{closeDialog(){this.$emit("close-dialog")},validate(){""===this.newBranchName?(this.branchNameError=this.$t("branch.nameRequired"),this.isError=!1):this.branchNames.includes(this.newBranchName)?(this.branchNameError=this.$t("branch.nameExists"),this.isError=!1):(this.branchNameError="",this.isError=!0)},async addBranch(){if(this.wait=!0,this.validate(),this.isError){this.$store.dispatch(s.Ay.create,{branchName:this.newBranchName,refBranch:this.refBranch});for(let e=0;e<30;e++){if(await this.$store.dispatch(s.Ay.fetch,1),this.branchNames.includes(this.newBranchName))break;await new Promise((e=>setTimeout(e,1e3)))}this.wait=!1,this.closeDialog()}else this.wait=!1}}},m=u,f=r(1656),b=(0,f.A)(m,p,d,!1,null,null,null),g=b.exports,v={name:"BranchAccess",components:{AddBranchModal:g,TdSelectionPage:h.A},data(){return{showNewBranchDialog:!1}},computed:(0,o.aH)({branches:e=>e.branch.all.map((e=>e["protected"]?{value:e.name,icon:"lock",iconTooltip:"branch.protectedBranch"}:e.name)),provider:e=>e.provider.selected,providerType:e=>(0,n.sG)(e.provider.selected),providerUri:e=>e.provider.providerUri,repoName:e=>e.repo.selected,page:e=>Number(e.branch.page),pageNext:e=>e.branch.pageNext,pagePrev:e=>e.branch.pagePrev}),mounted(){this.provider!==this.$route.params.provider&&this.$store.dispatch(c.Ay.selected,this.$route.params.provider),this.repoName!==this.$route.params.repository&&this.$store.dispatch(l.Ay.selected,this.$route.params.repository),this.$store.dispatch(s.Ay.fetch,1)},methods:{selectRepoClick(){this.$store.dispatch(l.Ay.clear),this.$router.push({name:`${this.providerType}Repository`})},onBranchClick(e){this.$store.dispatch(s.Ay.selected,e);const t=Object.assign({},this.$route.params,{branch:e}),r=`${this.providerType}${"create"===this.$route.query.action?"NewThreatModel":"ThreatModelSelect"}`;this.$router.push({name:r,params:t})},paginate(e){this.$store.dispatch(s.Ay.fetch,e)},toggleNewBranchDialog(){this.showNewBranchDialog=!this.showNewBranchDialog}}},y=v,w=(0,f.A)(y,a,i,!1,null,null,null),N=w.exports}}]);
//# sourceMappingURL=branch-access.312c513a.js.map